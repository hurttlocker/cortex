# Cortex v0.3.5-rc1 Auditor Command Pack

Audit target:
- Repo: `hurttlocker/cortex`
- Tag: `v0.3.5-rc1`
- Focus: release reliability gates + visualizer v1 contract closure
- Gate summary: see `docs/audits/v0.3.5-rc1-go-no-go.md`

## 1) Environment / provenance

```bash
git clone https://github.com/hurttlocker/cortex.git
cd cortex
git checkout v0.3.5-rc1

go version
```

## 2) Build + baseline tests

```bash
go test ./...
go vet ./...
go build -o ./bin/cortex ./cmd/cortex
./bin/cortex version
```

Expected:
- tests pass
- vet pass
- binary prints `cortex 0.3.5-rc1` (or release ldflags version)

## 3) Release + runtime gate checks

```bash
scripts/release_checklist.sh --tag v0.3.5-rc1
scripts/connectivity_smoke.sh --cortex-bin ./bin/cortex
scripts/audit_rc_smoke.sh
```

Expected:
- all commands pass
- strict mode section in RC smoke still emits WARN lines and non-zero signaling when fixture forces guardrail warnings

## 4) One-command preflight evidence pack

```bash
scripts/audit_preflight.sh --tag v0.3.5-rc1
```

Expected artifacts:
- `docs/audits/v0.3.5-rc1-preflight.md`
- `docs/audits/v0.3.5-rc1-preflight-logs/*.log`

## 5) Visualizer contract closure checks

```bash
python3 -m py_compile scripts/visualizer_export.py scripts/visualizer_api.py scripts/validate_visualizer_contract.py
python3 scripts/validate_visualizer_contract.py
```

Expected:
- canonical contract includes retrieval lists for `bm25`, `semantic`, and `hybrid`
- canonical contract includes `retrieval.deltas[]` with rank movement + reason
- canonical graph contains bounded `max_hops` and `max_nodes`

## 6) Adversarial break harness (recommended)

```bash
scripts/audit_break_harness.sh --cortex-bin ./bin/cortex
```

Expected:
- missing telemetry path is handled gracefully (warn-only 0, strict non-zero)
- missing import path fails cleanly (non-zero + clear error)
- symlink-loop recursive import fails cleanly (no stack overflow)
- unreadable recursive subtrees are surfaced as explicit import errors
- known concurrency/lock-recovery regression tests pass

## 7) Manual spot checks (optional but recommended)

```bash
python3 scripts/visualizer_export.py \
  --output docs/visualizer/data/latest.json \
  --obsidian-output docs/visualizer/data/obsidian-graph.json \
  --obsidian-vault-dir docs/visualizer/data/obsidian-vault

python3 scripts/visualizer_api.py --bootstrap --port 8787
# open http://127.0.0.1:8787/prototype-v1.html
```

Check:
- Retrieval Debug panel shows BM25 + semantic + hybrid and delta reasons
- Provenance graph remains bounded and focus-node oriented

## 8) Audit notes template

Capture:
- tag + commit tested
- full command transcript
- pass/fail per section
- deviations from expected output
- recommendations for follow-up before stable promotion
